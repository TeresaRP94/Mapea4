!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=74)}({0:function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,null,[{key:"init",value:function(){if(!1===e.initialized){e.initialized=!0;var t=document.createElement("img");t.src=M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24.svg"]),t.width="24",t.height="24",t.crossOrigin="anonymous";var n=document.createElement("IMG");n.src=M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24-new.svg"]),n.width="24",n.height="24",n.crossOrigin="anonymous";var o=document.createElement("IMG");o.src=M.utils.concatUrlPaths([M.config.THEME_URL,"/img/m-pin-24-sel.svg"]),o.width="24",o.height="24",o.crossOrigin="anonymous",e.DEFAULT[M.geom.wkt.type.POINT]=new ol.style.Style({image:new ol.style.Icon({img:t,imgSize:[24,24]})}),e.DEFAULT[M.geom.wkt.type.LINE_STRING]=new ol.style.Style({fill:new ol.style.Fill({color:"#A15BD7"}),stroke:new ol.style.Stroke({color:"#A15BD7",width:2})}),e.DEFAULT[M.geom.wkt.type.POLYGON]=new ol.style.Style({image:new ol.style.Icon({img:t,imgSize:[24,24]})}),e.DEFAULT[M.geom.wkt.type.MULTI_POINT]=e.DEFAULT[M.geom.wkt.type.POINT],e.DEFAULT[M.geom.wkt.type.LINEAR_RING]=e.DEFAULT[M.geom.wkt.type.LINE_STRING],e.DEFAULT[M.geom.wkt.type.MULTI_LINE_STRING]=e.DEFAULT[M.geom.wkt.type.LINE_STRING],e.DEFAULT[M.geom.wkt.type.MULTI_POLYGON]=e.DEFAULT[M.geom.wkt.type.POLYGON],e.DEFAULT[M.geom.wkt.type.CIRCLE]=e.DEFAULT[M.geom.wkt.type.POLYGON],e.DEFAULT[M.geom.wkt.type.GEOMETRY_COLLECTION]=e.DEFAULT[M.geom.wkt.type.POLYGON],e.NEW[M.geom.wkt.type.POINT]=new ol.style.Style({image:new ol.style.Icon({img:n,imgSize:[24,24]})}),e.NEW[M.geom.wkt.type.LINE_STRING]=new ol.style.Style({fill:new ol.style.Fill({color:"#e2951b"}),stroke:new ol.style.Stroke({color:"#e2951b",width:2})}),e.NEW[M.geom.wkt.type.POLYGON]=new ol.style.Style({image:new ol.style.Icon({img:n,imgSize:[24,24]})}),e.NEW[M.geom.wkt.type.MULTI_POINT]=e.NEW[M.geom.wkt.type.POINT],e.NEW[M.geom.wkt.type.LINEAR_RING]=e.NEW[M.geom.wkt.type.LINE_STRING],e.NEW[M.geom.wkt.type.MULTI_LINE_STRING]=e.NEW[M.geom.wkt.type.LINE_STRING],e.NEW[M.geom.wkt.type.MULTI_POLYGON]=e.NEW[M.geom.wkt.type.POLYGON],e.NEW[M.geom.wkt.type.CIRCLE]=e.NEW[M.geom.wkt.type.POLYGON],e.NEW[M.geom.wkt.type.GEOMETRY_COLLECTION]=e.NEW[M.geom.wkt.type.POLYGON],e.SELECTED[M.geom.wkt.type.POINT]=new ol.style.Style({image:new ol.style.Icon({img:o,imgSize:[24,24]})}),e.SELECTED[M.geom.wkt.type.LINE_STRING]=new ol.style.Style({fill:new ol.style.Fill({color:"#fcfcfc"}),stroke:new ol.style.Stroke({color:"#3589d1",width:2})}),e.SELECTED[M.geom.wkt.type.POLYGON]=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(240, 220, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#a15bd7",width:2})}),e.SELECTED[M.geom.wkt.type.MULTI_POINT]=e.SELECTED[M.geom.wkt.type.POINT],e.SELECTED[M.geom.wkt.type.LINEAR_RING]=e.SELECTED[M.geom.wkt.type.LINE_STRING],e.SELECTED[M.geom.wkt.type.MULTI_LINE_STRING]=e.SELECTED[M.geom.wkt.type.LINE_STRING],e.SELECTED[M.geom.wkt.type.MULTI_POLYGON]=e.SELECTED[M.geom.wkt.type.POLYGON],e.SELECTED[M.geom.wkt.type.CIRCLE]=e.SELECTED[M.geom.wkt.type.POLYGON],e.SELECTED[M.geom.wkt.type.GEOMETRY_COLLECTION]=e.SELECTED[M.geom.wkt.type.POLYGON]}}}]),e}();function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}r.DEFAULT={},r.NEW={},r.SELECTED={},r.initialized=!1;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(e,null,[{key:"getCentroidCoordinate",value:function(t){var n,o,r,s,i,a;return t.getType()===M.geom.wkt.type.POINT?n=t.getCoordinates():t.getType()===M.geom.wkt.type.LINE_STRING?n=(o=t.getCoordinates())[r=Math.floor(o.length/2)]:t.getType()===M.geom.wkt.type.LINEAR_RING?n=(o=t.getCoordinates())[r=Math.floor(o.length/2)]:t.getType()===M.geom.wkt.type.POLYGON?n=e.getCentroidCoordinate(t.getInteriorPoint()):t.getType()===M.geom.wkt.type.MULTI_POINT?(s=t.getPoints(),r=Math.floor(s.length/2),n=e.getCentroidCoordinate(s[r])):t.getType()===M.geom.wkt.type.MULTI_LINE_STRING?(i=t.getLineStrings(),r=Math.floor(i.length/2),n=e.getCentroidCoordinate(i[r])):t.getType()===M.geom.wkt.type.MULTI_POLYGON?(s=t.getInteriorPoints(),n=e.getCentroidCoordinate(s)):t.getType()===M.geom.wkt.type.CIRCLE?n=t.getCenter():t.getType()===M.geom.wkt.type.GEOMETRY_COLLECTION&&(a=t.getGeometries(),r=Math.floor(a.length/2),n=e.getCentroidCoordinate(a[r])),n}}]),e}(),a=n(4),l=n.n(a);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e,t,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"geosearch",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=o;return(e=p(this,y(t).call(this,r))).wktFormatter_=new ol.format.WKT,e.popup_=null,e.selectedFeatures_=[],r.displayInLayerSwitcher||(r.displayInLayerSwitcher=!1),e.name=n,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,M.impl.layer.Vector),function(e,t,n){t&&c(e.prototype,t),n&&c(e,n)}(t,[{key:"addTo",value:function(e){h(y(t.prototype),"addTo",this).call(this,e),this.ol3Layer.setSource(new ol.source.Vector({useSpatialIndex:!1}))}},{key:"drawResults",value:function(e){var n=this,o=ol.proj.get(this.map.getProjection().code),r=[];M.utils.isNullOrEmpty(e.spatial_response)||(r=e.spatial_response.docs),M.utils.isNullOrEmpty(r)&&(r=e.response.docs);var s=r.map(function(e){var r=n.wktFormatter_.readFeature(e.geom,{dataProjection:o});return r.setId(e.solrid),r.setProperties(e),t.setStyleFeature(r,M.style.state.DEFAULT),n.wrapComplexFeature_(r),M.impl.Feature.olFeature2Facade(r)},this);this.facadeVector_.addFeatures(s)}},{key:"drawNewResults",value:function(e){var n,o=this,r=ol.proj.get(this.map.getProjection().code);M.utils.isNullOrEmpty(e.spatial_response)?M.utils.isNullOrEmpty(e.response)||(n=e.response.docs):n=e.spatial_response.docs;var s=n.map(function(e){var n=o.wktFormatter_.readFeature(e.geom,{dataProjection:r});return n.setId(e.solrid),n.setProperties(e),t.setStyleFeature(n,M.style.state.NEW),M.impl.Feature.olFeature2Facade(n)},this);this.facadeVector_.addFeatures(s)}},{key:"clear",value:function(e){this.map.removePopup(),this.facadeVector_.clear()}},{key:"selectFeatures",value:function(e,n,o,r){var s=this,i=e;this.unselectFeatures(),this.selectedFeatures_=i,i=i.map(M.impl.Feature.facade2OLFeature),t.setStyleFeature(i,M.style.state.SELECTED);var a={jsonp:!0,vars:this.parseFeaturesForTemplate_(i),parseToHtml:!1},u={icon:"g-cartografia-pin",title:"Geosearch",content:M.template.compileSync(l.a,a)},c=this.map.getPopup();M.utils.isNullOrEmpty(c)?((c=new M.Popup({panMapIfOutOfView:!r,ani:null})).addTab(u),this.map.addPopup(c,n)):c.addTab(u),c.on(M.evt.DESTROY,function(){s.internalUnselectFeatures_(!0)},this)}},{key:"selectFeatureBySolrid",value:function(e){var t=this.facadeVector_.getFeatureById(e);this.selectedFeatures_=[t];var n=t.getImpl().getOLFeature().getGeometry(),o=i.getCentroidCoordinate(n);this.unselectFeatures(),this.selectFeatures([t],o,null,!0),this.map.setBbox(n.getExtent())}},{key:"parseFeaturesForTemplate_",value:function(e){var t={features:[]};return e.forEach(function(e){var n=["geom","_version_","keywords","solrid",e.getGeometryName()],o=e.getProperties(),r=[];Object.keys(o).forEach(function(e){M.utils.includes(n,e.toLowerCase())||r.push({key:M.utils.beautifyAttributeName(e),value:o[e]})});var s={solrid:e.getId(),attributes:r};t.features.push(s)}),t}},{key:"wrapComplexFeature_",value:function(e){var t=e.getGeometry();if(t.getType()===M.geom.wkt.type.POLYGON||t.getType()===M.geom.wkt.type.MULTI_POLYGON){var n;n=t.getType()===M.geom.wkt.type.POLYGON?t.getInteriorPoint():t.getInteriorPoints();var o=new ol.geom.GeometryCollection([n,t]);e.setGeometry(o)}}},{key:"unselectFeatures",value:function(e,t){this.internalUnselectFeatures_()}},{key:"internalUnselectFeatures_",value:function(e){this.selectedFeatures_.length>0&&(t.setStyleFeature(this.selectedFeatures_.map(M.impl.Feature.facade2OLFeature),M.style.state.DEFAULT),this.selectedFeatures_.length=0,e||this.map.removePopup())}},{key:"setNewResultsAsDefault",value:function(){t.setStyleFeature(this.facadeVector_.getFeatures().map(M.impl.Feature.facade2OLFeature),M.style.state.DEFAULT)}},{key:"getCentroidCoordinate",value:function(e){var t,n,o,r,s,i;return e.getType()===M.geom.wkt.type.POINT?t=e.getCoordinates():e.getType()===M.geom.wkt.type.LINE_STRING?t=(n=e.getCoordinates())[o=Math.floor(n.length/2)]:e.getType()===M.geom.wkt.type.LINEAR_RING?t=(n=e.getCoordinates())[o=Math.floor(n.length/2)]:e.getType()===M.geom.wkt.type.POLYGON?t=this.getCentroidCoordinate(e.getInteriorPoint()):e.getType()===M.geom.wkt.type.MULTI_POINT?(r=e.getPoints(),o=Math.floor(r.length/2),t=this.getCentroidCoordinate(r[o])):e.getType()===M.geom.wkt.type.MULTI_LINE_STRING?(s=e.getLineStrings(),o=Math.floor(s.length/2),t=this.getCentroidCoordinate(s[o])):e.getType()===M.geom.wkt.type.MULTI_POLYGON?(r=e.getInteriorPoints(),t=this.getCentroidCoordinate(r)):e.getType()===M.geom.wkt.type.CIRCLE?t=e.getCenter():e.getType()===M.geom.wkt.type.GEOMETRY_COLLECTION&&(i=e.getGeometries(),o=Math.floor(i.length/2),t=this.getCentroidCoordinate(i[o])),t}},{key:"destroy",value:function(){var e=this.map.getMapImpl();M.utils.isNullOrEmpty(this.ol3Layer)||(e.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map=null,this.wktFormatter_=null,this.popup_=null,this.selectedFeatures_=null,this.name=null}},{key:"equals",value:function(e){var n=!1;return e instanceof t&&(n=this.url===e.url,n=n&&this.name===e.name),n}},{key:"getFeaturesExtentPromise",value:function(e,t){var n=this;return new Promise(function(o){var r=n.map.getProjection().code;if(!0===n.isLoaded()){var s=n.getFeatures(e,t),i=M.impl.utils.getFeaturesExtent(s,r);o(i)}else n.requestFeatures_().then(function(e){var t=M.impl.utils.getFeaturesExtent(e,r);o(t)})})}}],[{key:"setStyleFeature",value:function(e,t){var n=e;r.init(),M.utils.isArray(n)||(n=[n]),n.forEach(function(e){var n=e.getGeometry().getType();M.utils.isNullOrEmpty(t)||t===M.style.state.DEFAULT?e.setStyle(r.DEFAULT[n]):t===M.style.state.NEW?e.setStyle(r.NEW[n]):t===M.style.state.SELECTED&&e.setStyle(r.SELECTED[n])})}}]),t}();function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}m.POPUP_RESULT="geosearchfeaturepopup.html";var E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new m;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=_(this,v(t).call(this,n,o,{},r)),M.utils.isUndefined(m)&&M.exception("La implementación usada no puede crear capas Geosearch"),e.displayInLayerSwitcher=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,M.layer.Vector),function(e,t,n){t&&g(e.prototype,t),n&&g(e,n)}(t,[{key:"equals",value:function(e){return!1}}]),t}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function L(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return T});var T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=L(this,O(t).call(this))).facadeMap_=null,e.helpHtml_=null,e.layer_=new E({name:n.layerName}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,M.impl.Control),function(e,t,n){t&&S(e.prototype,t),n&&S(e,n)}(t,[{key:"addTo",value:function(e,t){this.facadeMap_=e,e.addLayers(this.layer_),ol.control.Control.call(this,{element:t,target:null}),e.getMapImpl().addControl(this)}},{key:"unselectResults",value:function(e){this.layer_.getImpl().unselectFeatures(e)}},{key:"setNewResultsAsDefault",value:function(){this.layer_.getImpl().setNewResultsAsDefault()}},{key:"drawResults",value:function(e){this.layer_.getImpl().drawResults(e)}},{key:"drawNewResults",value:function(e){this.layer_.getImpl().drawNewResults(e)}},{key:"zoomToResults",value:function(){var e=ol.extent.boundingExtent(this.layer_.getImpl().getOL3Layer().getSource().getFeatures().map(function(e){return ol.extent.getCenter(e.getGeometry().getExtent())}));this.facadeMap_.setBbox(e)}},{key:"getLayer",value:function(){return this.layer_}},{key:"resultClick",value:function(e){this.layer_.getImpl().selectFeatureBySolrid(e)}},{key:"hideHelp",value:function(){M.utils.isNullOrEmpty(this.helpHtml_)||(this.facadeMap_.getMapImpl().getTargetElement().removeChild(this.helpHtml_),this.helpHtml_=null)}},{key:"showHelp",value:function(e){var t=this.facadeMap_.getMapImpl().getTargetElement();M.utils.isNullOrEmpty(this.helpHtml_)||t.removeChild(this.helpHtml_),this.helpHtml_=e,t.appendChild(this.helpHtml_)}},{key:"clear",value:function(){this.layer_.clear()}},{key:"destroy",value:function(){this.clear(),this.facadeMap_.areasContainer.getElementsByClassName("m-top m-right")[0].classList.remove("top-extra"),this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null,this.helpHtml_=null,this.layer_=null}}]),t}()},1:function(e,t){e.exports='<div class="results-panels">\n   {{#if partial}}\n   <div class="partial">\n      <p>No se han encontrado resultados para la búsqueda.</p>\n      <p>A continuación se muestran otros resultados que quizás le interesen:...</p>\n   </div>\n   {{/if}}\n   <div class="results" id="m-geosearch-results-scroll">\n      {{#each docs}}\n      <div id="{{solrid}}" class="result">\n         {{#each attributes}}\n         <table>\n            <tbody>\n               <tr>\n                  <td class="key">{{key}}</td>\n                  <td class="value{{#oneword value}} m-wordbreak{{/oneword}}">{{{value}}}</td>\n               </tr>\n            </tbody>\n         </table>\n         {{/each}}\n      </div>\n      {{/each}}\n   </div>\n   {{#eq docs.length 0}}\n   <div class="results">\n      <div class="partial">No se han encontrado resultados para la búsqueda "{{query}}".</div>\n   </div>\n   {{/eq}}\n   <div class="page">\n      <span class="found" id="m-geosearch-page-found">{{docs.length}}</span> de <span class="total">{{total}}</span>\n      <div class="g-cartografia-flecha-arriba"></div>\n   </div>\n</div>'},2:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var o=n(0),r=n(5),s=n.n(r),i=n(1),a=n.n(i),l=n(6),u=n.n(l);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(e,n,r,s,i){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=new o.a;return a=h(this,y(t).call(this,l,t.NAME)),M.utils.isUndefined(o.a)&&M.exception("La implementación usada no puede crear controles Geosearch"),a.input_=null,a.element_=null,a.resultsContainer_=null,a.resultsScrollContainer_=null,a.searchingResult_=null,a.searchTime_=0,a.url_=e,a.core_=n,a.handler_=r,a.searchUrl_=M.utils.concatUrlPaths([a.url_,a.core_,a.handler_]),a.helpUrl_=M.utils.concatUrlPaths([a.url_,a.core_,"/help"]),a.searchParameters_=s,M.utils.isNullOrEmpty(a.searchParameters_)||(M.utils.isNullOrEmpty(a.searchParameters_.rows)&&(a.searchParameters_.rows=M.config.GEOSEARCH_ROWS),a.searchUrl_=M.utils.addParameters(a.searchUrl_,a.searchParameters_)),a.results_=[],a.showHelp_=i,a.scrollIsUp_=!0,a.spatialSearch_=!1,a.facadeMap_=null,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,M.Control),function(e,t,n){t&&p(e.prototype,t),n&&p(e,n)}(t,[{key:"createView",value:function(e){this.facadeMap_=e;var t=M.template.compileSync(s.a,{jsonp:!0});return!1===this.showHelp_&&t.querySelector("#m-geosearch-help-btn").classList.add("m-hidden"),this.addEvents(t),t}},{key:"addEvents",value:function(e){var t=this;this.element_=e,this.on(M.evt.COMPLETED,function(){t.element_.classList.add("shown")},this),this.input_=this.element_.getElementsByTagName("input")["m-geosearch-search-input"],this.input_.addEventListener("keyup",this.searchClick.bind(this)),this.element_.getElementsByTagName("button")["m-geosearch-search-btn"].addEventListener("click",this.searchClick.bind(this));var n=this.element_.getElementsByTagName("button")["m-geosearch-help-btn"];n&&n.addEventListener("click",function(e){e.preventDefault(),n.classList.toggle("shown"),t.helpClick_()}),this.element_.getElementsByTagName("button")["m-geosearch-clear-btn"].addEventListener("click",this.clearClick_.bind(this)),this.resultsContainer_=this.element_.querySelector("div#m-geosearch-results"),M.utils.enableTouchScroll(this.resultsContainer_),this.searchingResult_=this.element_.querySelector("div#m-geosearch-results > div#m-searching-result")}},{key:"addEventsHelp",value:function(e){this.element_=e,this.element_.getElementsByTagName("button")["m-geosearch-closeHelp-btn"].addEventListener("click",this.closeHelpClick_.bind(this))}},{key:"searchClick",value:function(e){if(e.preventDefault(),"keyup"!==e.type||13===e.keyCode){this.results_.length=0;var t=this.input_.value;M.utils.isNullOrEmpty(t)?M.dialog.info("Debe introducir una búsqueda."):this.search_(t,this.showResults_)}}},{key:"resultClick_",value:function(e){var t=e;t.preventDefault(),M.window.WIDTH<=M.config.MOBILE_WIDTH&&(t.target=this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba"),this.resultsClick_(t)),this.facadeMap_.removePopup();var n=t.currentTarget.id;this.getImpl().resultClick(n)}},{key:"search_",value:function(e,n){var o=this;this.resultsContainer_.appendChild(this.searchingResult_),this.searchTime_=Date.now(),this.element_.classList.add(t.SEARCHING_CLASS);var r=M.utils.addParameters(this.searchUrl_,{q:e,start:this.results_.length,srs:this.facadeMap_.getProjection().code});!function(e){M.remote.get(r).then(function(r){if(e===o.searchTime_){var s;try{s=JSON.parse(r.text)}catch(e){M.exception("La respuesta no es un JSON válido: ".concat(e))}n.call(o,s),o.element_.classList.remove(t.SEARCHING_CLASS)}})}(this.searchTime_)}},{key:"showResults_",value:function(e){this.getImpl().clear(),this.drawResults(e);var n={jsonp:!0,vars:this.parseResultsForTemplate_(e)},o=M.template.compileSync(a.a,n);this.resultsContainer_.classList.remove(t.HIDDEN_RESULTS_CLASS),M.utils.isNullOrEmpty(this.resultsScrollContainer_)||this.resultsScrollContainer_.removeEventListener("scroll",this.resultsScroll_);for(var r=this.resultsContainer_.querySelectorAll(".result"),s=0,i=r.length;s<i;s+=1)r.item(s).removeEventListener("click",this.resultClick_.bind(this));e.response.docs.length>0&&this.zoomToResults();var l=this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba");M.utils.isNullOrEmpty(l)||l.removeEventListener("click",this.resultsClick_.bind(this)),this.resultsContainer_.innerHTML=o.innerHTML,this.resultsScrollContainer_=this.resultsContainer_.querySelector("div#m-geosearch-results-scroll"),M.utils.enableTouchScroll(this.resultsScrollContainer_),this.resultsScrollContainer_.addEventListener("scroll",this.resultsScroll_.bind(this));for(var u=0,c=(r=this.resultsContainer_.getElementsByClassName("result")).length;u<c;u+=1)r.item(u).addEventListener("click",this.resultClick_.bind(this));(l=this.resultsContainer_.querySelector("div.page > div.g-cartografia-flecha-arriba")).addEventListener("click",this.resultsClick_.bind(this)),this.checkScrollSearch_(e),this.fire(M.evt.COMPLETED)}},{key:"drawResults",value:function(e){this.getImpl().drawResults(e)}},{key:"drawNewResults",value:function(e){this.getImpl().drawNewResults(e)}},{key:"zoomToResults",value:function(){this.getImpl().zoomToResults()}},{key:"getInput",value:function(){return this.input_}},{key:"appendResults_",value:function(e){var t=this;this.drawNewResults(e);for(var n={jsonp:!0,vars:this.parseResultsForTemplate_(e,!0)},o=M.template.compileSync(a.a,n).getElementsByTagName("div")["m-geosearch-results-scroll"].children,r=0;r<o.length;r+=1){var s=o.item(r);this.resultsScrollContainer_.appendChild(s),s.addEventListener("click",function(e){return t.resultClick_(e)})}this.resultsContainer_.getElementsByTagName("span")["m-geosearch-page-found"].innerHTML=this.results_.length,this.checkScrollSearch_(e)}},{key:"resultsScroll_",value:function(e){var t=e.target,n=t.offsetHeight,o=t.scrollHeight-t.scrollTop-n<=15;o&&this.scrollIsUp_?(this.scrollIsUp_=!1,this.scrollSearch_()):o||(this.scrollIsUp_=!0)}},{key:"scrollSearch_",value:function(){this.getImpl().unselectResults(!0),this.getImpl().setNewResultsAsDefault();var e=this.input_.value;this.search_(e,this.appendResults_)}},{key:"helpClick_",value:function(e){var t=this;!0===this.helpShown_?(this.getImpl().hideHelp(),this.helpShown_=!1):M.remote.get(this.helpUrl_).then(function(e){var n;try{n=JSON.parse(e.text)}catch(e){M.Exception("La respuesta no es un JSON válido: ".concat(e))}var o={jsonp:!0,vars:{entities:n}},r=M.template.compileSync(u.a,o);t.addEventsHelp(r),t.getImpl().showHelp(r),t.helpShown_=!0})}},{key:"closeHelpClick_",value:function(e){!0===this.helpShown_&&(this.getImpl().hideHelp(),this.helpShown_=!1)}},{key:"clearClick_",value:function(e){this.element_.classList.remove("shown"),M.utils.isNullOrEmpty(this.input_)||(this.input_.value=""),M.utils.isNullOrEmpty(this.resultsContainer_)||(this.resultsContainer_.innerHTML=""),M.utils.isNullOrEmpty(this.resultsScrollContainer_)||(this.resultsScrollContainer_.innerHTML="",this.resultsScrollContainer_=null),this.results_.length=0,this.resultsContainer_.classList.remove(t.HIDDEN_RESULTS_CLASS),this.getImpl().clear(),this.getImpl().hideHelp(),this.spatialSearch_=!1}},{key:"resultsClick_",value:function(e){this.facadeMap_.areasContainer.getElementsByClassName("m-top m-right")[0].classList.add("top-extra-search"),e.target.classList.toggle("g-cartografia-flecha-arriba"),e.target.classList.toggle("g-cartografia-flecha-abajo"),this.resultsContainer_.classList.toggle(t.HIDDEN_RESULTS_CLASS)}},{key:"equals",value:function(e){var n=!1;return e instanceof t&&(n=this.name===e.name),n}},{key:"parseResultsForTemplate_",value:function(e,t){var n="";M.utils.isNullOrEmpty(this.input_)||(n=this.input_.value);var o=0;M.utils.isUndefined(e.spatial_response)?(o=e.response.numFound,this.spatialSearch_=!1):(o=e.spatial_response.numFound,this.spatialSearch_=!0);var r=this.getDocsFromResults_(e);this.results_=!0===t?this.results_.concat(r):r;var s=this.spatialSearch_&&M.utils.isNullOrEmpty(e.spatial_response.docs);return 0!==o?{docs:r,total:o,partial:s}:{docs:r,total:o,notResutls:!0,query:n}}},{key:"getDocsFromResults_",value:function(e){var t=["geom","_version_","keywords","solrid"];return(this.spatialSearch_?e.spatial_response.docs:e.response.docs).map(function(e){var n=[];return Object.keys(e).forEach(function(o){M.utils.includes(t,o)||n.push({key:M.utils.beautifyAttributeName(o),value:e[o]})}),{solrid:e.solrid,attributes:n}})}},{key:"checkScrollSearch_",value:function(e){var t=0;t=M.utils.isUndefined(e.spatial_response)?e.response.numFound:e.spatial_response.numFound,this.results_.length!==t||M.utils.isNullOrEmpty(this.resultsScrollContainer_)||this.resultsScrollContainer_.removeEventListener("scroll",this.resultsScroll_)}}]),t}();m.NAME="geosearch",m.TEMPLATE="geosearch.html",m.RESULTS_TEMPLATE="geosearchresults.html",m.HELP_TEMPLATE="geosearchhelp.html",m.SEARCHING_CLASS="m-searching",m.HIDDEN_RESULTS_CLASS="hidden"},27:function(e,t){e.exports='<div class="m-geosearchbylocation-content">\n   <div>\n      <table>\n         <tr>\n            <td>X:</td>\n            <td>{{valorX}}</td>\n         </tr>\n         <tr>\n            <td>Y:</td>\n            <td>{{valorY}}</td>\n         </tr>\n      </table>\n   </div>\n</div>'},28:function(e,t){e.exports='<div class="m-control m-geosearchbylocation-container" id="m-geosearchbylocation-div" title="Geobúsquedas por geolocalización">\n   <button id="m-geosearchbylocation-button" class="g-cartografia-posicion7"></button>\n   <button id="m-geosearchbylocation-button-list" class="g-cartografia-lista hidden"></button>\n</div>'},29:function(e,t){e.exports='<div class="m-geosearchbylocation-results-panel">\n   <div class="title">\n           B&uacute;squeda por localizaci&oacute;n\n            <button class="m-panel-btn"></button>\n    </div>\n   <div class="results" id="m-geosearchbylocation-results-scroll">\n      {{#each docs}}\n      <div id="{{solrid}}" class="result">\n         {{#each attributes}}\n         <table>\n            <tbody>\n               <tr>\n                  <td class="key">{{key}}</td>\n                  <td class="value">{{{value}}}</td>\n               </tr>\n            </tbody>\n         </table>\n         {{/each}}\n      </div>\n      {{/each}}\n   </div>\n   <div class="page">\n      <span class="total">{{total}} resultados.</span>\n   </div>\n</div>'},30:function(e){e.exports={url:{name:"geosearchbylocation",separator:"*"},constructor:"M.plugin.Geosearchbylocation",parameters:[{type:"object",properties:[{type:"simple",name:"distance",position:0},{type:"simple",name:"url",position:1},{type:"simple",name:"core",position:2},{type:"simple",name:"handler",position:3}]}],files:{ol:{scripts:["geosearchbylocation-2.0.0.ol.min.js"],styles:["geosearchbylocation-2.0.0.min.css"]}},metadata:{name:"GeosearchByLocation",description:"Search for locations within a given radius from a location user.",text:"",version:"2.0.0",date:"11/10/2019",author:"Junta de Andalucía",org:"Junta de Andalucía",tags:"mapea,plugin",icon:"./facade/assets/icons/icons.svg"}}},4:function(e,t){e.exports='<div class="m-geosearch-content">\n   {{#each features}}\n   <div id="{{solrid}}" class="result">\n      {{#each attributes}}\n      <table>\n         <tr>\n            <td class="key">{{key}}</td>\n            <td class="value{{#oneword value}} m-wordbreak{{/oneword}}">{{{value}}}</td>\n         </tr>\n      </table>\n      {{/each}}\n   </div>\n   <div class="m-separator"></div>\n   {{/each}}\n</div>'},5:function(e,t){e.exports='<div class="m-control m-geosearch-container">\n  \x3c!-- search panel --\x3e\n  <div class="search-panel">\n    <input type="text" id="m-geosearch-search-input" placeholder="Buscar" class="m-input-search" />\n    <button id="m-geosearch-search-btn" class="g-cartografia-zoom m-search-btn" title="Buscar"></button>\n    <button id="m-geosearch-help-btn" class="g-cartografia-ayuda m-help-btn" title="Ayuda"></button>\n    <button id="m-geosearch-clear-btn" class="g-cartografia-cancelar m-clear-btn" title="Limpiar búsqueda"></button>\n  </div>\n  \x3c!-- results panel --\x3e\n  <div class="results-panel" id="m-geosearch-results">\n    <div id="m-searching-result" class="m-searching-result g-cartografia-spinner"></div>\n  </div>\n</div>'},58:function(e,t,n){},6:function(e,t){e.exports='<div class="m-geosearch-help">\n  {{#eq entities.length 0}}\n    <div class="entity">\n      <p>El servicio no tiene ayuda configurada</p>\n      <button id="m-geosearch-closeHelp-btn" class="g-cartografia-cancelar" title="Cerrar ayuda"></button>\n    </div>\n  {{/eq}}\n  {{#each entities}}\n    <div class="entity">\n      <button id="m-geosearch-closeHelp-btn" class="g-cartografia-cancelar m-clear-btn" title="Cerrar ayuda"></button>\n      <div class="name">{{entity}}</div>\n      <div class="info">{{info}}</div>\n      <ul class="keywords">\n        {{#each keywords}}\n          <li>{{this}}</li>\n        {{/each}}\n      </ul>\n      <div class="example">\n        <code>{{example}}</code>\n      </div>\n    </div>\n  {{/each}}\n</div>'},74:function(e,t,n){"use strict";n.r(t);var o=n(2),r=n(0),s=n(27),i=n.n(s);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,p(t).call(this,{layerName:t.NAME}))).popup_=null,n.searchUrl_=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,r["a"]),function(e,t,n){t&&l(e.prototype,t),n&&l(e,n)}(t,[{key:"setMap",value:function(e){c(p(t.prototype),"setMap",this).call(this,e),M.utils.isNullOrEmpty(e)?this.facadeMap_.getImpl().removeFeatures([this.positionFeature_]):this.map=e}},{key:"locate",value:function(){var e,t=this,n=new ol.Geolocation({projection:this.facadeMap_.getMapImpl().getView().getProjection()});return n.setTracking(!0),this.positionFeature_=M.impl.Feature.olFeature2Facade(new ol.Feature),this.positionFeature_.getImpl().getOLFeature().setStyle(new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#3399CC"}),stroke:new ol.style.Stroke({color:"#fff",width:2})})})),this.positionFeature_.click=function(n){var o={jsonp:!0,vars:{valorX:e[0],valorY:e[1]},parseToHtml:!1},r={icon:"g-cartografia-gps2",title:"posición",content:M.template.compileSync(i.a,o)};t.popup_=t.facadeMap_.getPopup(),M.utils.isNullOrEmpty(t.popup_)?(t.popup_=new M.Popup,t.popup_.addTab(r),t.facadeMap_.addPopup(t.popup_,e)):t.popup_.addTab(r)},new Promise(function(o,r){n.on("change:position",function(){n.setTracking(!1),e=n.getPosition(),o(e)},t)})}},{key:"removeLocate",value:function(){this.facadeMap_.removeFeatures([this.positionFeature_])}},{key:"drawLocation",value:function(e){this.positionFeature_.getImpl().getOLFeature().setGeometry(e?new ol.geom.Point(e):null),this.facadeMap_.drawFeatures([this.positionFeature_])}},{key:"addResultsContainer",value:function(e){this.map.getTargetElement().appendChild(e)}},{key:"removeResultsContainer",value:function(e){null!==e&&null!=e.parentElement&&e.parentElement.removeChild(e)}},{key:"zoomToResultsAll",value:function(){var e=this.facadeMap_.getControls("geosearchbylocation")[0].getImpl().getLayer().getFeaturesExtent();this.facadeMap_.setBbox(e)}},{key:"destroy",value:function(){this.facadeMap_.getMapImpl().removeControl(this),this.clear(),this.facadeMap_.removeFeatures([this.positionFeature_]),this.popup_=null,this.searchUrl_=null}}]),t}();y.POPUP_LOCATION="geosearchbylocationfeaturepopup.html";var f=n(28),m=n.n(f),d=n(29),g=n.n(d);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(e,n,o,r,s,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=b(this,E(t).call(this,e,n,o))).impl_=new y(a.searchUrl_),a.activate_=!0,a.activatebtnList_=!0,a.distance_=r,a.spatialField_=s,a.rows_=i,a.searchUrl_=M.utils.concatUrlPaths([e,n,o]),a.facadeMap_=null,a.resultsScrollContainer_=null,M.utils.isUndefined(y)&&M.Exception("La implementación usada no puede crear controles Geosearchbylocation"),a.name=t.NAME,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,o["a"]),function(e,t,n){t&&v(e.prototype,t),n&&v(e,n)}(t,[{key:"equals",value:function(e){var n=!1;return e instanceof t&&(n=this.name===e.name),n}},{key:"createView",value:function(e){return this.facadeMap_=e,M.template.compileSync(m.a,{jsonp:!0})}},{key:"getActivationButton",value:function(e){return e.querySelector("button#m-geosearchbylocation-button")}},{key:"activate",value:function(){var e=this;this.element_.classList.add("activated"),this.element_.classList.add(o.a.SEARCHING_CLASS),this.getImpl().locate().then(function(t){var n=new ol.geom.Point(t),o=(new ol.format.WKT).writeGeometry(n);e.searchFrom_(o,t)})}},{key:"deactivate",value:function(){this.element_.classList.remove("activated"),this.getImpl().clear(),this.getImpl().removeLocate(),this.getImpl().removeResultsContainer(this.resultsContainer_)}},{key:"drawLocation_",value:function(e){this.getImpl().drawLocation(e)}},{key:"searchFrom_",value:function(e,t){var n,r=this;n=M.utils.addParameters(this.searchUrl_,{wt:"json",pt:e,q:"*:*",start:0,d:this.distance_,spatialField:this.spatialField_,rows:this.rows_,srs:this.map_.getProjection().code}),this.searchTime_=Date.now(),function(e){M.remote.get(n).then(function(n){if(e===r.searchTime_){var s;try{s=JSON.parse(n.text)}catch(e){M.Exception("La respuesta no es un JSON válido:".concat(e))}r.showResults_(s),r.drawLocation_(t),r.zoomToResultsAll_(),r.activationBtn_.classList.remove(o.a.HIDDEN_RESULTS_CLASS),r.element_.classList.remove(o.a.SEARCHING_CLASS)}})}(this.searchTime_)}},{key:"zoomToResultsAll_",value:function(){this.getImpl().zoomToResultsAll()}},{key:"showResults_",value:function(e){this.getImpl().clear(),this.results=e,this.showList=!0,this.drawResults(e),this.element_.querySelector("button#m-geosearchbylocation-button-list").onclick=this.showList_.bind(this)}},{key:"showList_",value:function(){var e=this;if(!0===this.showList){var t={jsonp:!0,vars:this.parseResultsForTemplate_(this.results)},n=M.template.compileSync(g.a,t);this.resultsContainer_=n,this.resultsScrollContainer_=this.resultsContainer_.querySelector("div#m-geosearchbylocation-results-scroll"),M.utils.enableTouchScroll(this.resultsScrollContainer_),this.getImpl().addResultsContainer(this.resultsContainer_);for(var o=this.resultsContainer_.getElementsByClassName("result"),r=0,s=o.length;r<s;r+=1){o.item(r).addEventListener("click",function(t){e.resultClick_(t),e.getImpl().removeResultsContainer(e.resultsContainer_),e.showList=!0})}n.querySelector(".title > button.m-panel-btn").addEventListener("click",this.showList_.bind(this)),this.showList=!1}else this.getImpl().removeResultsContainer(this.resultsContainer_),this.showList=!0}},{key:"resultsClick_",value:function(e){this.resultsContainer_.classList.toggle(o.a.HIDDEN_RESULTS_CLASS)}}]),t}();S.NAME="geosearchbylocation",S.HIDDEN="hidden",S.TEMPLATE="geosearchbylocation.html",S.RESULTS_TEMPLATE="geosearchbylocationresults.html";n(58);var L=n(30);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function T(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=T(this,C(t).call(this))).name=t.NAME,e.url_=M.config.GEOSEARCH_URL,M.utils.isNullOrEmpty(n.url)||(e.url_=n.url),e.core_=M.config.GEOSEARCH_CORE,M.utils.isNullOrEmpty(n.core)||(e.core_=n.core),e.handler_=M.config.GEOSEARCH_HANDLER,M.utils.isNullOrEmpty(n.handler)||(e.handler_=n.handler),e.distance_=M.config.GEOSEARCH_DISTANCE,M.utils.isNullOrEmpty(n.distance)||(e.distance_=n.distance),e.spatialField_=M.config.GEOSEARCH_SPATIAL_FIELD,e.rows_=M.config.GEOSEARCHBYLOCATION_ROWS,e.map_=null,e.controlGeo_=null,e.panel_=null,e.metadata_=L.metadata,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,M.Plugin),function(e,t,n){t&&k(e.prototype,t),n&&k(e,n)}(t,[{key:"addTo",value:function(e){this.map_=e,this.controlGeo_=new S(this.url_,this.core_,this.handler_,this.distance_,this.spatialField_,this.rows_),this.panel_=new M.ui.Panel(t.NAME,{collapsible:!1,className:"m-geosearchbylocation",position:M.ui.position.BR});var n=e.getPanels([M.control.Location.NAME])[0];M.utils.isNullOrEmpty(n)||M.utils.isNullOrEmpty(void 0)?M.utils.isNullOrEmpty(n)?M.utils.isNullOrEmpty(void 0)||((void 0).addClassName("m-with-geosearchbylocation"),this.panel_.addClassName("m-with-streetview")):(n.addClassName("m-with-geosearchbylocation"),this.panel_.addClassName("m-with-location")):(n.addClassName("m-with-geosearchbylocation"),(void 0).addClassName("m-with-geosearchbylocation"),this.panel_.addClassName("m-with-location m-with-streetview")),this.panel_.addControls(this.controlGeo_),this.map_.addPanels(this.panel_)}},{key:"destroy",value:function(){this.map_.removeControls([this.controlGeo_]),this.controlGeo_=null,this.name=null,this.url_=null,this.core_=null,this.handler_=null,this.distance_=null,this.spatialField_=null,this.rows_=null,this.map_=null,this.controlGeo_=null,this.panel_=null}},{key:"getControls",value:function(){var e=[];return e.push(this.controlGeo_),e}},{key:"equals",value:function(e){return e instanceof t}},{key:"getAPIRest",value:function(){return"geosearchbylocation=".concat(this.distance_,"*").concat(this.url_,"*").concat(this.core_,"*").concat(this.handler_)}},{key:"getMetadata",value:function(){return this.metadata_}}]),t}();I.NAME="geosearchbylocation",null==window.M.plugin&&(window.M.plugin={}),window.M.plugin.Geosearchbylocation=I}});